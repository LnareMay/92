<!DOCTYPE html>
<html lang="ko-KR" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<head th:insert="~{layouts/meta_tag :: headMeta}"></head>
<title>체육관 예약 시스템</title>
<!-- 공통 css -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/5.3.3/litera/bootstrap.min.css"
	integrity="sha512-TUtnNUXMMWp2IALAR9t2z1vuorOUQL4dPWG3J9ANInEj6xu/rz5fzni/faoEGzuqeY1Z1yGD6COYAW72oiDVYA=="
	crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" th:href="@{/css/common.css}">
<!-- Linking CSS files -->
<link rel="stylesheet" th:href="@{/css/detail_hj.css}" />
<link rel="stylesheet" th:href="@{/css/detail_yj.css}" />

<!--flatpickr -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<!-- 공통 js -->
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
	crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<!--flatpickr -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://npmcdn.com/flatpickr/dist/l10n/ko.js"></script>
<script type="text/javascript"
	src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script type="text/javascript"
	src="https://cdn.iamport.kr/js/iamport.payment-1.1.5.js"></script>

<style>
/* 폼 스타일 */
.booking-form {
	width: 100%; /* 반응형 너비 */
	padding: 20px; /* 내부 여백 */
	background-color: #f8f9fa; /* 연한 회색 배경 */
	border-radius: 10px; /* 모서리 둥글게 */
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* 그림자 효과 */
}

.form-group {
	margin-bottom: 15px;
}

.form-group label {
	font-weight: bold;
	display: inline-block;
	vertical-align: top;
}

.form-group span {
	display: inline-block;
	color: #333;
	font-size: 14px;
	line-height: 1.5;
	white-space: pre-line; /* 줄바꿈 유지 */
}

/* .booking-form button {
	background-color: #007bff; 
	color: white;
	padding: 10px 20px;
	border: none;
	border-radius: 5px; 
	cursor: pointer;
} */

/* .booking-form button:hover {
	background-color: #0056b3; 
} */

/* Carousel 컨테이너 높이 설정 */
.carousel-inner {
	max-height: 500px; /* 원하는 고정 높이 */
	overflow: hidden; /* 초과 이미지를 숨김 */
	display: flex
}

/* Carousel 이미지 스타일 */
.carousel-item img {
	width: 100%; /* 컨테이너 너비에 맞춤 */
	height: 100%; /* 컨테이너 높이에 맞춤 */
	/* 이미지 비율을 유지하며 컨테이너 내에 맞춤 */
	/*  object-position: center; */ /* 이미지를 중앙에 위치  */
}
</style>
</head>
<!-- Header -->
<div th:insert="~{layouts/header :: header}"></div>
<body>
	<div class="container my-4">
		<a th:href="@{/facility/main}" class="more-link"> ◀시설예약목록 </a>
		<div id="carouselExampleIndicators" class="carousel slide"
			data-bs-ride="carousel">
			<div class="carousel-indicators">
				<button type="button" data-bs-target="#carouselExampleIndicators"
					data-bs-slide-to="0" class="active" aria-current="true"
					aria-label="Slide 1" th:if="${facility.facilityImage1 != null}"></button>
				<button type="button" data-bs-target="#carouselExampleIndicators"
					data-bs-slide-to="1" aria-label="Slide 2"
					th:if="${facility.facilityImage2 != null}"></button>
				<button type="button" data-bs-target="#carouselExampleIndicators"
					data-bs-slide-to="2" aria-label="Slide 3"
					th:if="${facility.facilityImage3 != null}"></button>
				<button type="button" data-bs-target="#carouselExampleIndicators"
					data-bs-slide-to="3" aria-label="Slide 4"
					th:if="${facility.facilityImage4 != null}"></button>
			</div>

			<div class="carousel-inner">
				<div class="carousel-item active" data-bs-interval="5000"
					th:if="${facility.facilityImage1 != null}">
					<img th:src="|/view/${facility.facilityImage1}|"
						id="facilityImage1" alt="Product Image">
				</div>
				<div class="carousel-item" data-bs-interval="5000"
					th:if="${facility.facilityImage2 != null}">
					<img th:src="|/view/${facility.facilityImage2}|"
						id="facilityImage2" alt="Product Image">
				</div>
				<div class="carousel-item" data-bs-interval="5000"
					th:if="${facility.facilityImage3 != null}">
					<img th:src="|/view/${facility.facilityImage3}|"
						id="facilityImage3" alt="Product Image">
				</div>
				<div class="carousel-item" data-bs-interval="5000"
					th:if="${facility.facilityImage4 != null}">
					<img th:src="|/view/${facility.facilityImage4}|"
						id="facilityImage4" alt="Product Image">
				</div>
			</div>
			<button class="carousel-control-prev" type="button"
				data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="visually-hidden">Previous</span>
			</button>
			<button class="carousel-control-next" type="button"
				data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="visually-hidden">Next</span>
			</button>
		</div>

		<div style="padding-top: 10px;">
			<!-- 예약 form start  -->
			<form class="booking-form" action="/facility/submit-booking"
				method="POST">

				<div th:if="${facility.facilityIsOnlyClub}"
					style="color: red; font-weight: bold;">
					<span>✅ 해당 시설은 클럽장만 예약할 수 있는 시설입니다</span>
				</div>
				<br />

				<div class="form-group resInfo">
					<label for="memId" class="changeToClub">예약자ID: </label> <span id="memId" name="memId"
						th:text="${userId}"></span> <input type="text" id="memId"
						name="memId" class="blind" th:value="${userId}"> <input
						type="text" id="senderId" class="blind" name="senderId"
						th:value="${userId}"> <input type="text" class="blind"
						id="receiverId" name="receiverId" th:value="${facility.memId}">

				</div>

				<div class="form-group">
					<label for="reservationDate">예약 날짜</label> <input
						id="reservationDate" name="reservationDate" type="date"
						placeholder="날짜를 선택하세요" required>
				</div>

				<div class="form-group">
					<input type="hidden" name="isOnlyClub" th:value="${facility.facilityIsOnlyClub}">
					<label for="reservationTime">예약 시간</label> <select
						id="reservationStartTime" name="reservationStartTime" type="time"
						required></select> <select id="reservationEndTime"
						name="reservationEndTime" type="time" required></select>
					<!-- 옵션이 JavaScript로 동적으로 추가됩니다 -->

					<label id="countLabel" for="count">예약 인원</label> <input type="number" id="count"
						name="count" placeholder="예약 인원을 입력해주세요." required>
				</div>


				<div class="form-group">
					<label for="price">시간 당 이용 요금(1hour):</label> <span
						th:text="${facility.formattedPrice}"></span>원 <input type="number"
						id="price" class="blind" name="price" th:value="${facility.price}">
				</div>
				<div class="form-group">
					<label for="totalPrice">최종 결제 금액:</label> <span class="totalPrice">0</span>원
				</div>
				<hr />
				<!-- 결제 옵션 -->
				<h4>결제하기</h4>
				<div id="paymentOptions">
					<label for="memMoney" class="form-label me-2">FITPAY 잔액:</label> <span
						id="memMoney" th:text="${#authentication.principal.memMoney}"></span>원
					<input type="number" id="memMoney_ip" name="memMoney" class="blind">
					<input type="number" id="useFitpay" class="form-control me-2"
						placeholder="사용할 금액 입력"
						style="width: 150px; display: inline-block">
					<button class="btn btn-secondary" id="useFitpayButton"
						type="button">사용</button>
					<button class="btn btn-primary" id="useFullAmount" type="button">전액
						사용</button>
					<button class="btn btn-danger" id="deleteAmount" type="button">취소</button>
				</div>
				<div>
					<button class="btn btn-success" id="fitpayCharge" type="button">FITPAY
						충전하기</button>
					<button class="btn btn-danger" id="inisisBtn"
						type="button">KG이니시스 결제하기</button>
				</div>



				<!-- 숨겨진 FITPAY 충전 영역 -->
				<div id="fitpayOptions" style="display: none; margin-top: 20px;">
					<h5>FITPAY 충전</h5>
					<div class="d-flex align-items-center mb-3">

						<label for="chargeAmount" class="form-label me-2">충전 금액:</label> <input
							type="number" id="chargeAmount" class="form-control me-2"
							placeholder="금액 입력" style="width: 150px;">
					</div>

					<div>
						<button class="btn btn-warning charge-btn" type="button"
							id="chargeBtn_kakao" data-pg="kakaopay">카카오페이</button>
						<button class="btn btn-success charge-btn" type="button"
							id="chargeBtn_naver" data-pg="naverpay">네이버페이</button>
						<button class="btn btn-danger charge-btn" type="button"
							id="chargeBtn_payco" data-pg="payco">페이코</button>
					</div>
				</div>
				<div class="form-group">
					<label for="totalPrice">최종 결제 금액:</label> <span class="totalPrice">0</span>원
					<input type="hidden" id="amount" name="amount" value="0">
				</div>

				<div class="form-group mt-3">
					<label for="totalPaid">낸 금액:</label> <span id="totalPaid">0</span>원
				</div>

				<div class="form-group">
					<label for="remainingAmount">내야할 금액:</label> <span
						id="remainingAmount">0</span>원
				</div>
				<button th:if="${!facility.facilityIsOnlyClub}" type="submit" class="btn btn-primary">예약하기</button>
	      <button th:if="${facility.facilityIsOnlyClub && isClubOwner}" type="submit" class="btn btn-primary">예약하기</button>
				<hr />
				<!-- 시설명  -->
				<div class="form-group">
					<label for="facilityName">시설명:</label> <span
						th:text="${facility.facilityName}"></span> <input type="hidden"
						id="facilityName" name="facilityName"
						th:value="${facility.facilityName}"> <input type="hidden"
						id="facilityCode" name="facilityCode"
						th:value="${facility.facilityCode}">
				</div>
				<!-- 시설 주소  -->
				<div class="form-group">
					<label for="facilityAddress">시설 주소: </label> <span
						th:text="${facility.facilityAddress}"></span>
				</div>
				<div class="form-group">
					<label for="facilityDescription">이용안내: </label> <span
						style="white-space: pre-line;"
						th:text="${facility.facilityDescription}"></span>
				</div>
				<!-- 시설 운영 시간 -->
				<div class="form-group">
					<label for="facilityTime">운영 시간:</label> <span
						th:text="${facility.facilityStartTime + ' ~ ' + facility.facilityEndTime}"></span>
				</div>




			</form>
		</div>

	</div>



	<!-- Footer -->
	<div th:insert="~{layouts/footer :: footer}"></div>

	<script>
        // 날짜 선택 Flatpickr 초기화
        flatpickr("#reservationDate", {
            dateFormat: "Y-m-d", // 날짜 형식 (YYYY-MM-DD)
            minDate: "today", // 오늘 이후만 선택 가능
            allowInput: true, // 사용자가 직접 입력 가능
            locale: "ko" // 한국어 설정
        });

    </script>

	<script th:inline="javascript">

    // 서버에서 전달받은 운영 시간 (Thymeleaf 변수 사용)
    const facilityStartTime =  /*[[${facility.facilityStartTime}]]*/"9:00";	//서버에서 받지 못했을 때 기본 값 9:00
    const facilityEndTime =  /*[[${facility.facilityEndTime}]]*/"22:00"; //서버에서 받지 못했을 때 기본 값 22:00
    const pricePerHour = parseFloat(/*[[${facility.price}]]*/ "10000");
    let memMoney = parseFloat(/*[[${#authentication.principal.memMoney}]]*/ "10000"); // 사용자 잔액
    let totalPaid = 0;
	const isClubOwner = /*[[${isClubOwner}]]*/"";
	const facilityIsOnlyClub = /*[[${facility.facilityIsOnlyClub}]]*/"";
   
    
    // 최종 결제 금액 계산
    function calculateTotalPrice() {
        const startTime = document.getElementById("reservationStartTime").value;
        const endTime = document.getElementById("reservationEndTime").value;

        if (startTime && endTime) {
            const start = new Date(`1970-01-01T${startTime}`);
            const end = new Date(`1970-01-01T${endTime}`);
            const duration = (end - start) / (1000 * 60 * 60); // 시간 차 계산
            const totalPrice = duration * pricePerHour;
            document.querySelectorAll(".totalPrice").forEach((element) => {
                element.textContent = totalPrice;
            });
			document.getElementById("remainingAmount").textContent =totalPrice;
			return totalPrice;
        }
		return 0;
    }
    
    document.getElementById("reservationStartTime").addEventListener("change", function(){
    	document.querySelectorAll(".totalPrice").forEach((element) => {
            element.textContent = pricePerHour;
        });
    });
    document.getElementById("reservationEndTime").addEventListener("change", calculateTotalPrice, calculateAmountToPay);
    
    // 내야할 금액 계산
   function calculateAmountToPay() {
	   document.getElementById("remainingAmount").textContent -= totalPaid;
    };
    calculateAmountToPay();
     
    // 금액 초기화 함수
    function reset(){
    	 const useFitpayInput = parseFloat(document.getElementById("useFitpay").value);
    	
    	 memMoney = memMoney + totalPaid;
    	totalPaid = 0;
        const totalPrice = pricePerHour - totalPaid; // 최종 금액 다시 계산
        
        const remainingAmount = totalPrice;

        // UI 초기화
        document.getElementById("memMoney_ip").value = memMoney;
        document.getElementById("memMoney").textContent = memMoney;
        document.getElementById("totalPaid").textContent = totalPaid;
        document.getElementById("remainingAmount").textContent = totalPrice;
        document.getElementById("useFitpay").value = "";
        return;
    	    
    }
    
    // 취소 버튼 누를시, 다시 원상복귀
    document.getElementById("deleteAmount").addEventListener("click",reset);
    		
   
    
    
 // '사용' 버튼 클릭 이벤트
    document.getElementById("useFitpayButton").addEventListener("click", () => {
    	// reset();
        const useFitpayInput = parseFloat(document.getElementById("useFitpay").value);

        if (isNaN(useFitpayInput) || useFitpayInput < 0) {
            alert("올바른 금액을 입력해주세요.");
            return;
        }


        if (useFitpayInput > memMoney) {
            alert("잔액이 부족합니다.");
            return;
        }

        // 값 업데이트
        memMoney -= useFitpayInput;
        totalPaid += useFitpayInput;
        const remainingAmount = Math.max(pricePerHour - totalPaid, 0);
        document.getElementById("memMoney_ip").value = memMoney;

        // UI 업데이트
        document.getElementById("memMoney").textContent = memMoney;
        document.getElementById("totalPaid").textContent = totalPaid;
        document.getElementById("useFitpay").value = "";
        document.getElementById("remainingAmount").textContent = remainingAmount;
    });


    // '전액 사용' 버튼 클릭 이벤트
    document.getElementById("useFullAmount").addEventListener("click", () => {
    	// reset();
    	document.getElementById("useFitpay").value = calculateTotalPrice();
    	  const useFitpayInput = parseFloat(document.getElementById("useFitpay").value);
    

          if (isNaN(useFitpayInput) || useFitpayInput < 0) {
              alert("올바른 금액을 입력해주세요.");
              return;
          }


          if (useFitpayInput > memMoney) {
              alert("잔액이 부족합니다.");
              return;
          }

          // 값 업데이트
          memMoney -= useFitpayInput;
          totalPaid += useFitpayInput;
          const remainingAmount = Math.max(pricePerHour - totalPaid, 0);
          document.getElementById("memMoney_ip").value = memMoney;

          // UI 업데이트
          document.getElementById("memMoney").textContent = memMoney;
          document.getElementById("totalPaid").textContent = totalPaid;
          document.getElementById("useFitpay").value = "";
          document.getElementById("remainingAmount").textContent = remainingAmount;
    });

    
 // 운영 시간 기반으로 예약 가능한 시간 생성 <예약 시작 시간>
    function generateReservationStartTimes(startTime, endTime) {
        const startSelect = document.getElementById("reservationStartTime");
        const start = new Date(`1970-01-01T${startTime}`);
        const end = new Date(`1970-01-01T${endTime}`);
        const interval = 60; // 60분 간격

        startSelect.innerHTML = ""; // 기존 옵션 제거

        while (start < end) {
            const timeString = start.toTimeString().slice(0, 5); // HH:MM 형식
            const option = document.createElement("option");
            option.value = timeString;
            option.textContent = timeString;
            startSelect.appendChild(option);
            start.setMinutes(start.getMinutes() + interval); // 60분 간격으로 증가
        }
    }

    // 운영 시간 기반으로 예약 가능한 시간 생성 <예약 종료 시간>
    function generateReservationEndTimes(selectedStartTime, endTime) {
        const endSelect = document.getElementById("reservationEndTime");
        const start = new Date(`1970-01-01T${selectedStartTime}`);
        const end = new Date(`1970-01-01T${endTime}`);
        const interval = 60; // 60분 간격

        endSelect.innerHTML = ""; // 기존 옵션 제거

        while (start < end) {
            start.setMinutes(start.getMinutes() + interval); // 60분 추가
            // if (start >= end) break; // 종료 시간이 운영 시간을 초과하면 중지

            const timeString = start.toTimeString().slice(0, 5); // HH:MM 형식
            const option = document.createElement("option");
            option.value = timeString;
            option.textContent = timeString;
            endSelect.appendChild(option);
        }
    }

    // 이벤트 연결
    document.getElementById("reservationStartTime").addEventListener("change", function () {
        const selectedStartTime = this.value; // 선택된 시작 시간
        generateReservationEndTimes(selectedStartTime, facilityEndTime); // 종료 시간 생성
    });

    // 초기 시간 목록 생성
    generateReservationStartTimes(facilityStartTime, facilityEndTime);
    document.getElementById("reservationStartTime").dispatchEvent(new Event("change"));

    
    
    
    
    
 // FITPAY 충전하기 버튼 클릭 이벤트
    document.getElementById("fitpayCharge").addEventListener("click", function () {
        const fitpayOptions = document.getElementById("fitpayOptions");
        fitpayOptions.style.display = fitpayOptions.style.display === "none" ? "block" : "none";
    });
    
    
    $(function () {
        // 공통 클래스 사용
        $('.charge-btn').off("click").on("click", function (event) {
            event.preventDefault(); // 기본 동작 방지

            var IMP = window.IMP; // 아임포트 객체
            IMP.init('imp85150653'); // 아임포트 가맹점 식별코드

            var money = parseFloat($('#chargeAmount').val());
            if (isNaN(money) || money <= 0) {
                alert("충전 금액을 올바르게 입력하세요.");
                return;
            }

            // 클릭된 버튼에 따라 PG 설정
            var pgProvider = $(this).attr('data-pg'); // 버튼에 설정된 PG 값 가져오기
            
            if(pgProvider == "naverpay"){
            	alert("서비스 준비중입니다.");
            	return;
            }
            
            IMP.request_pay({
                pg: pgProvider, // 결제수단 (kakaopay 또는 naverpay)
                pay_method: 'card',
                merchant_uid: 'merchant_' + new Date().getTime(), // 고유 주문 ID
                name: 'FITPAY 충전',
                amount: money,
                buyer_email: '/*[[${#authentication.principal.memEmail}]]*/',
                buyer_name: '/*[[${#authentication.principal.memName}]]*/',
                buyer_tel: '/*[[${#authentication.principal.memTell}]]*/',
                buyer_addr: '/*[[${#authentication.principal.memAddress}]]*/',
                buyer_postcode: '/*[[${#authentication.principal.memZipcode}]]*/'
            }, function (rsp) {
                if (rsp.success) {
                	alert("결제가 성공했습니다!");
                    memMoney += money; // 충전 금액 추가
                    $("#memMoney_ip").val(memMoney);
                    $("#memMoney").text(memMoney.toLocaleString());

                    // 서버로 충전 금액 전송
                    $.ajax({
                        type: "GET",
                        url: "/member/charge/point",
                        data: { "amount": memMoney, "plusPoint": money },
                        success: function (response) {
                            console.log("충전 성공: ", response);
                            $("#chargeAmount").val("");
                            alert("충전이 완료되었습니다. 충전 금액: " + money + "원");
                        },
                        error: function (xhr, status, error) {
                            console.error("충전 실패: ", error);
                            alert("충전 중 문제가 발생했습니다.");
                        }
                    });
                } else {
                    alert("결제가 실패했습니다. 다시 시도해주세요.");
                }
            });
        });
        
        // paymentInisis
        $('#inisisBtn').off("click").on("click", function (event) {
		    paymentInisis(event); // event 객체를 전달
		});

        
     // 버튼 이벤트 핸들러 등록
        $('#inisisBtn').off("click").on("click", function (event) {
            paymentInisis(event);
        });

        function paymentInisis(event) {
            if (event) event.preventDefault(); // 기본 동작 방지

            var IMP = window.IMP; // 아임포트 객체
            IMP.init('imp85150653'); // 아임포트 가맹점 식별코드

            // 결제 금액 가져오기
            var money = parseFloat($('.totalPrice:first').text().replace(/[^0-9.]/g, '')); // 숫자만 추출
            console.log("결제 금액:", money); // 디버깅 로그

            if (isNaN(money) || money <= 0) {
                alert("결제 금액을 올바르게 입력하세요.");
                return;
            }

            // 이메일 처리
            var buyerEmail = '/*[[${#authentication.principal.memEmail}]]*/';
            buyerEmail = buyerEmail.replace(/^\/\*|"|\*\/$/g, "").trim();
            console.log("이메일 값:", buyerEmail); // 디버깅 로그

            // IMP.request_pay 호출
            IMP.request_pay(
                {
                    pg: 'html5_inicis',
                    pay_method: 'card',
                    merchant_uid: 'merchant_' + new Date().getTime(),
                    name: 'FITPAY 결제',
                    amount: money,
                    buyer_email: buyerEmail,
                    buyer_name: '/*[[${#authentication.principal.memName}]]*/',
                    buyer_tel: '/*[[${#authentication.principal.memTell}]]*/',
                    buyer_addr: '/*[[${#authentication.principal.memAddress}]]*/',
                    buyer_postcode: '/*[[${#authentication.principal.memZipcode}]]*/'
                },
                function (rsp) {
                    alert("결제 응답:", rsp); // 디버깅 로그

                    if (rsp.success) {
                        alert("결제가 성공했습니다!");

                        // 서버로 결제 정보 전송 후 폼 제출
                        $.ajax({
                            type: "POST",
                            url: "/facility/pay-by-inisis", // 서버의 결제 완료 처리 URL
                            data: {
                                imp_uid: rsp.imp_uid,
                                merchant_uid: rsp.merchant_uid,
                                amount: money
                            },
                            success: function (response) {
                                console.log("서버 응답:", response); // 디버깅 로그
                                alert("결제가 완료되었습니다.");

                                // 폼 제출
                                $(".booking-form").submit();
                            },
                            error: function (xhr, status, error) {
                                console.error("결제 검증 실패:", error); // 디버깅 로그
                                alert("결제 검증 중 문제가 발생했습니다.");
                            }
                        });
                    } else {
                        console.error("결제 실패:", rsp.error_msg);
                        alert(`결제가 실패했습니다. 이유: ${rsp.error_msg}`);
                    }
                }
            );
        }

    });
  



    
	async function getClubList(){
    	const response = await axios.get(`/club/ownerClubList`)
    	return response.data
	}


	if(facilityIsOnlyClub == true && isClubOwner == true) {
		let str = "";
		getClubList().then(data => {
			str = '<select class="custom-select" id="inputGroupSelect01" name="clubCode" style="text-align: center;" onchange="(selectBoxChange(this.value))">'
			data.forEach(club => {
				str += `<option selected value="${club.clubCode}">${club.clubName}</option>`
			});
			str += '</select>'
			document.querySelector(".changeToClub").textContent = "예약할 클럽"
			document.querySelector("#memId").classList.add("blind")
			document.querySelector(".resInfo").innerHTML += str
		})

	}
    
    // 최종 결제 금액을 숨겨진 input에 동적으로 복사
    function updateHiddenAmount() {
        const totalPriceElement = document.querySelector(".totalPrice");
        const amountInput = document.getElementById("amount");
        if (totalPriceElement && amountInput) {
            amountInput.value = parseFloat(totalPriceElement.textContent) || 0; // 숫자로 변환
        }
    }
    
    // '폼 제출' 버튼 클릭 전에 호출하여 최신 값을 설정
    const form = document.querySelector("form");
    form.addEventListener("submit", updateHiddenAmount);


	function selectBoxChange(value) {
		// document.querySelector("#senderId").value = value
	}
</script>


</body>

</html>
<!DOCTYPE html>
<html lang="ko-KR" xmlns:th="http://www.thymeleaf.org">
<head>
<!-- meta_tag include -->
<head th:insert="~{layouts/meta_tag :: headMeta}"></head>
<title>í´ëŸ½ ìƒì„¸</title>

<!-- ê³µí†µ css -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/5.3.3/litera/bootstrap.min.css"
	integrity="sha512-TUtnNUXMMWp2IALAR9t2z1vuorOUQL4dPWG3J9ANInEj6xu/rz5fzni/faoEGzuqeY1Z1yGD6COYAW72oiDVYA=="
	crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" th:href="@{/css/common.css}">
<!-- ì—¬ê¸°ì— ë³¸ì¸ css ì‘ì„±í•´ì£¼ì„¸ìš” (detail_hj.css) -->
<!-- Linking CSS files -->
<link rel="stylesheet" th:href="@{/css/detail_hj.css}" />
<link rel="stylesheet" th:href="@{/css/detail_yj.css}">

<!-- ê³µí†µ js -->
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
	crossorigin="anonymous"></script>

</head>
<body>
	<div th:insert="~{/layouts/header :: header}"></div>

 	<main class="container my-4">
 	<section>
        <!-- ëŒ€í‘œì´ë¯¸ì§€ -->
        	<div>
      			<img th:src="|/view/${clubdto.clubImage1}|" id="clubImage1" alt="í´ëŸ½ ëŒ€í‘œì´ë¯¸ì§€1" class="club-headerimg" onclick="openModal(0)">
        	</div>

			<div id="imageModal" class="modal">
			    <span class="close" onclick="closeModal()">&times;</span>
			    <div class="modal-content">
			        <img th:src="|/view/${clubdto.clubImage1}|" class="modal-image">
			        <img th:if="${clubdto.clubImage2 != null}" th:src="|/view/${clubdto.clubImage2}|" class="modal-image">
			        <img th:if="${clubdto.clubImage3 != null}" th:src="|/view/${clubdto.clubImage3}|" class="modal-image">
			        <img th:if="${clubdto.clubImage4 != null}" th:src="|/view/${clubdto.clubImage4}|" class="modal-image">
			    </div>
			    <button class="prev" onclick="changeSlide(-1)">&#10094;</button>
			    <button class="next" onclick="changeSlide(1)">&#10095;</button>
			</div>

			<!-- í´ëŸ½ ì •ë³´ -->
			<div class="club-header-content mt-3">
				<div>
					<h5 class="fw-bold mb-1" id="clubName"
						th:text="${clubdto.clubName}"></h5>

                <p class="text-muted mb-0 boardInfo">íšŒì› [[${clubdto.memberCount}]] Â· </p>

				</div>
			</div>

			<!-- í´ëŸ½ ì†Œê°œ -->
			<p class="mt-3 club-description"
				th:text="${clubdto.clubIntroduction}" style="margin-bottom: 10px"></p>
			<!-- í´ëŸ½ í…Œë§ˆ -->
			<p class="text-muted" th:text="${clubdto.themeName}"
				style="margin-bottom: 10px"></p>

			<!-- ê°€ì… ë²„íŠ¼ -->
			<form action="/club/club_join" method="post"
				onsubmit="return confirm('í´ëŸ½ì„ ê°€ì…í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');" style="display: inline;">
				<input type="hidden" name="clubCode" th:value="${clubdto.clubCode}" />
				<button type="submit" class="btn btn-warning ">í´ëŸ½ ê°€ì…í•˜ê¸°</button>
			</form>
			<span th:if="${clubdto.MemId == principal.memId}"> <a
				class="btn btn-success fw-bold modify-btn shadow-sm"
				th:href="@{/club/club_modify(clubCode=${clubdto.clubCode})}"> í´ëŸ½
					ìˆ˜ì •í•˜ê¸° </a>

				<form action="/club/club_remove" method="post"
					onsubmit="return confirm('í´ëŸ½ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');"
					style="display: inline;">
					<input type="hidden" name="clubCode" th:value="${clubdto.clubCode}" />
					<button type="submit" class="btn btn-danger">í´ëŸ½ ì‚­ì œí•˜ê¸°</button>
				</form>
			</span>

		</section>
				   <hr >
				
               <!-- ë©¤ë²„ ì„¹ì…˜ -->
                <div class="row">
                  <div class="col-md-6">
                    <section class="clubsection">
                      <div class="section-header mb-3">
                        <h6>ë©¤ë²„ [[${clubdto.memberCount}]]</h6>
                        <a th:href="@{/club/club_member(clubCode=${clubdto.clubCode})}"
                          class="more-link">ë”ë³´ê¸°</a>
                      </div>
                      <div class="d-flex flex-column">
                        <div class="d-flex align-items-center mb-3"
                          th:each="clubmember : ${limitmember}">
                           <img th:src="|/view/${clubmember.memberPicture}|" alt="í”„ë¡œí•„ì´ë¯¸ì§€">
                         <!--  <img src="https://ssl.pstatic.net/static/pwe/address/img_profile.png" alt="í”„ë¡œí•„ ì´ë¯¸ì§€"> -->

                          <div>
                            <p class="mb-1 fw-bold">
                              [[${clubmember.memId}]] <span
                                th:if="${clubmember.memId == clubdto.memId}"
                                class="text-warning small">â­</span>
                            </p>
                            <small class="text-muted" th:text="${clubdto.clubAddress}"></small>
                          </div>
                        </div>
                      </div>
			               </section>
			           </div>

			           <!-- ì¼ì • ì„¹ì…˜ -->
			           <div class="col-md-6">
			               <section class="clubsection">
			                   <div class="section-header mb-3">
			                       <h6>ì¼ì • 3</h6>
			                       <a href="/club/club_calendar" class="more-link">ë”ë³´ê¸° ></a>
			                   </div>
			                   <div>
			                       <!-- ê¸°ëŠ¥êµ¬í˜„ì•„ì§... 
			                       <div class="d-flex align-items-center mb-3">
			                           <div class="me-3 text-center">
			                               <div class="bg-light p-2 rounded">
			                                   <strong>12ì›”<br>16</strong>
			                               </div>
			                           </div>
			                           <div>
			                               <p class="mb-1 fw-bold">ë…ì„œê°€ ê³ë“¤ì—¬ì§„ ì¼ìƒ ê¸€ì“°ê¸° ëª¨ì„</p>
			                               <span class="text-danger small">ëª¨ì§‘ì¤‘</span><br>
			                               <small class="text-muted">ì˜¤í›„ 3:30 Â· 2/4ëª…</small>
			                           </div>
			                       </div>
			                       
			                       <div class="d-flex align-items-center mb-3">
			                           <div class="me-3 text-center">
			                               <div class="bg-light p-2 rounded">
			                                   <strong>12ì›”<br>16</strong>
			                               </div>
			                           </div>
			                           <div>
			                               <p class="mb-1 fw-bold">ìœ ì¢…ì˜ ë¯¸ ê±°ë‘ëŠ” ì—°ë§ë…ì„œ ê°™ì´í•´ìš”</p>
			                               <span class="text-muted small">ì¢…ë£Œ</span><br>
			                               <small class="text-muted">ì˜¤í›„ 5:00 Â· 1/4ëª…</small>
			                           </div>
			                       </div>
								   -->
			                   </div>
			               </section>
			           </div> 
				</div>

		<hr>
		<!-- ê²Œì‹œê¸€ ì„¹ì…˜ -->
		<section id="divBoard" ></section>
	</main>

	<div th:insert="~{layouts/footer :: footer}"></div>
</body>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="/js/gd.js"></script>
<script layout:fragment="script" th:inline="javascript">
	const clubCode = /*[[${clubdto.clubCode}]]*/''
	const boardList = document.querySelector("#divBoard");

	const boardInfo = document.querySelector(".boardInfo")

	function printBoardList(data) {
		boardInfo.innerHTML += `ê²Œì‹œê¸€ ${data.total}`

		let str = ''
		str += `<div class="section-header mb-3">
				    <h6>ê²Œì‹œê¸€ ${data.total}</h6>
				    <a href="/club/club_board?clubCode=${clubCode}&type=ALL" class="more-link">ë”ë³´ê¸°</a>
				</div>`
		if(data.dtoList && data.dtoList.length > 0) {
			for(const dto of data.dtoList) {
				str += `<div>
						<div class="d-flex mb-4">
							<div class="me-3" style="flex: 1;">
								<p class="board-text text-muted">${dto.boardText}</p>
								<small class="text-muted">${dto.memId} . ${dto.modDate} ì¼ ì „ . ${dto.type} <span class="ms-3 text-muted">ğŸ’¬${dto.replyCount}</span></small>
							</div>`
				if(dto.boardImages.length > 0) {
					for(const boardImage of dto.boardImages) {
						str += `<div>
									<img src="/club/view/s_${boardImage.uuid}_${boardImage.boardImage}" 

									onerror="this.src='https://via.placeholder.com/80'" class="rounded">
								</div>`
					}
				}
				str += `</div>
					</div>`
			}
		}
		boardList.innerHTML = str
	}

	function getBoard(clubCode, page, size) {
		getBoardList({clubCode, page, size})
		.then(
			data => {
				printBoardList(data)  // ëŒ“ê¸€ëª©ë¡ì²˜ë¦¬
			}
		).catch(
			e => console.log(e)
		)
	}

	getBoard(clubCode, 1, 3)

	/* ì´ë¯¸ì§€ëª¨ë‹¬ */
	let currentIndex = 0;
	const images = document.querySelectorAll('.modal-image');
	
	function openModal(index) {
		document.getElementById('imageModal').style.display = "flex";
		currentIndex = index;
		showSlide(currentIndex);
	}
	
	function closeModal() {
		document.getElementById('imageModal').style.display = "none";
	}
	
	function changeSlide(n) {
		showSlide(currentIndex = (currentIndex + n + images.length) % images.length);
	}
	
	function showSlide(index) {
			images.forEach((img, i) => {
			img.classList.toggle('active', i === index);
		});
	}
	

</script>
</html>